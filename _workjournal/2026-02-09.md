# 工作日誌 - 2026-02-09

## 完成項目

### 1. 圖片資源同步
- **任務**：將 `tcmclinic.png` 圖片同步到 Git 儲存庫
- **執行內容**：
  - 從建構輸出目錄 `_site/assets/images/` 複製圖片到源碼目錄 `assets/images/`
  - 提交並推送圖片到遠端儲存庫
- **提交記錄**：`87b0dcb` - "Add tcmclinic.png image to assets"
- **狀態**：✅ 完成

### 2. 修復搜尋功能
- **問題**：搜尋欄輸入「野人」關鍵字只顯示 1 篇文章，應該要顯示 2 篇
- **根本原因**：搜尋引擎只搜尋文章內文（body），忽略了標題（title）欄位
  - `【野人絮語8】演講後簡記` - 「野人」只出現在標題中，因此被排除在搜尋結果外
- **解決方案**：
  - 修改 `assets/gitbook/gitbook-plugin-search-pro/search.js` 的 `query` 函數
  - 改為同時搜尋 `title` 和 `body` 欄位
  - 對於只在標題中匹配的文章，顯示內文開頭作為摘要
- **驗證結果**：
  - 搜尋「野人」現在正確返回 2 筆結果
  - 兩篇文章都正常顯示：`[野人絮語9] 召喚路作為圖解的魔法` 和 `【野人絮語8】演講後簡記`
- **提交記錄**：`65e5c74` - "Fix search to include title field in search queries"
- **狀態**：✅ 完成並測試通過

### 3. 清理文章格式
- **任務**：移除文章內文中重複的標題
- **問題**：文章 `[野人絮語9] 召喚路作為圖解的魔法.md` 中的標題在 frontmatter 和內文中重複
- **解決方案**：刪除內文中的重複標題（Jekyll 會自動從 frontmatter 生成標題）
- **提交記錄**：`0831767` - "Remove duplicate title from post content"
- **狀態**：✅ 完成

## 技術細節

### 搜尋功能修復詳情
修改前的程式碼只檢查 body：
```javascript
if ((index = INDEX_DATA[page].body.toLowerCase().indexOf(keyword.toLowerCase())) !== -1) {
    results.push({...});
}
```

修改後同時檢查 title 和 body：
```javascript
var bodyIndex = INDEX_DATA[page].body.toLowerCase().indexOf(keyword.toLowerCase());
var titleIndex = INDEX_DATA[page].title.toLowerCase().indexOf(keyword.toLowerCase());

if (bodyIndex !== -1 || titleIndex !== -1) {
    var bodySnippet;
    if (bodyIndex !== -1) {
        bodySnippet = INDEX_DATA[page].body.substr(Math.max(0, bodyIndex - 50), MAX_DESCRIPTION_SIZE);
    } else {
        bodySnippet = INDEX_DATA[page].body.substr(0, MAX_DESCRIPTION_SIZE);
    }
    results.push({...});
}
```

## Git 提交記錄

```
0831767 Remove duplicate title from post content
65e5c74 Fix search to include title field in search queries
87b0dcb Add tcmclinic.png image to assets
```

## 備註

- 所有變更已成功推送到 GitHub 遠端儲存庫
- Jekyll 開發伺服器運行正常，即時重建功能正常運作
- 搜尋功能的修復需要使用者清除瀏覽器快取（Hard Refresh）才能看到效果

---

**日期**：2026-02-09  
**工作時間**：下午  
**總提交數**：3
